---
- hosts: all
  name: Setup Workspace
  remote_user: root
  serial: 1
  become: true

  vars_files:
    - config/var.yml
    - config/users.yml

  tasks:
  - name: Installation package de base
    ansible.builtin.apt:
      state: present
      update_cache: yes
      name:
        - zsh
        - zsh-syntax-highlighting
        - zsh-autosuggestions
        - sudo
        - grc
        - ccze

  roles:
    - { role: user/additional_packages, when: inventory_hostname == localhost }

- hosts: all
  name: Setup Workspace Parametrage
  remote_user: root
  serial: 1
  become: true

  vars_files:
    - config/var.yml
    - config/users.yml


  roles:
    - { role: user/sudo }
    - { role: user/zsh }
    - { role: user/ssh, when: (inventory_hostname == localhost) }
    - { role: user/my_user }
    - { role: user/link, when: (inventory_hostname == localhost) }
    - { role: user/git, when: (inventory_hostname == localhost) }


# - { role: user/ssh, when: (inventory_hostname == localhost) and (add_ssh) }
# - { role: user/link, when: (inventory_hostname == localhost) and (user.drive|length > 0) }
# - { role: user/git, when: (inventory_hostname == localhost) and (add_git) }